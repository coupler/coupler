<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Coupler</title>
  <meta http-equiv="content-type" content="text/html;charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <%= stylesheet_links %>
  <%= javascript_includes %>
</head>
<body>
<div id="main" class="container_16">

<div id="sidebar" class="grid_3">
<%= erb(:sidebar, :layout => false) %>
</div>

<div id="content" class="grid_13">
<%= breadcrumbs %>
<div class="inner">
  <%- if flash[:notice] -%>
  <div id="notice"<%= " class='#{flash[:notice_class]}'" if flash[:notice_class] %>><%= flash[:notice] %></div>
  <%- end -%>
  <%= yield %>
</div>
</div>
<div class="clear"></div>

<div id="about">
  <div class="text">
    Coupler is open source software.<br/>
    View the source <a href="http://github.com/coupler/coupler">here</a>.
  </div>
</div>

</div>

<script type="text/javascript">
  function updateJobCount() {
    $.get("/jobs/count", function(data) {
      if (data == "0") {
        $('#job-count').html("")
      } else {
        $('#job-count').html("("+data+")")
      }
    });
  }
  $(function() {
    $('.timeago').timeago();
    var accordion = $('#sidebar .accordion').accordion({
      collapsible: true, icons: false,
      navigation: true, autoHeight: false
    });
    accordion.find('button.more-projects').button({
      icons: { primary: 'ui-icon-circle-arrow-e' },
    }).click(function() { window.location.href = "/projects" });
    accordion.find('button.new-project').button({
      icons: { primary: 'ui-icon-circle-plus' },
    }).click(function() { window.location.href = "/projects/new" });
    <%#$('#sidebar ul').treeview({ unique: true, persist: "location" });%>
    //setInterval(updateJobCount, 30000);
  });
</script>
</body>
</html>
